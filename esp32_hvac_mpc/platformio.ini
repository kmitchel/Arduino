; PlatformIO Project Configuration File
; Self-contained build environment for ESP32 HVAC MPC
; Build: pio run
; Upload: pio run -t upload
; OTA: pio run -t upload --upload-port hvac-esp32.local

[platformio]
; Keep build artifacts in project directory
build_dir = .pio/build
libdeps_dir = .pio/libdeps
packages_dir = .pio/packages

[env:esp32]
platform = espressif32
board = esp32dev
board_build.partitions = min_spiffs.csv
framework = arduino

; Upload settings
upload_speed = 921600
monitor_speed = 115200

; OTA upload (uncomment when device is on network)
; OTA upload (uncomment when device is on network)
upload_protocol = espota
upload_port = esp32-8DC214.icr4sh.com
upload_flags =
    --auth=admin

; Libraries
lib_deps =
    ; WiFi and MQTT
    knolleary/PubSubClient@^2.8
    ; Temperature sensor
    paulstoffregen/OneWire@^2.3.7
    milesburton/DallasTemperature@^3.11.0
    ; JSON parsing for weather API
    bblanchon/ArduinoJson@^7.0.0
    ; HTTP client for weather API (built-in, but explicit)
    ; Web server for dashboard
    me-no-dev/ESPAsyncWebServer@^1.2.3
    me-no-dev/AsyncTCP@^1.1.1
    ; SPIFFS for persistence (built-in)
    ; Bluetooth (built-in)
    ; Ping for presence fallback
    marian-craciunescu/ESP32Ping@^1.7

; Build flags
build_flags =
    -DCORE_DEBUG_LEVEL=1
    -DCONFIG_ASYNC_TCP_RUNNING_CORE=1
    ; Increase stack size for async operations
    -DASYNC_TCP_SSL_ENABLED=0

; Partition scheme set at top (min_spiffs.csv)

; File system
board_build.filesystem = spiffs
